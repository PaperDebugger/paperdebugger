@import url('https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100..900;1,100..900&display=swap')
layer(base);
@import 'tailwindcss';

@import 'tailwindcss' layer(utilities);

@source "../node_modules/streamdown/dist/*.js";

@theme {
  /* Primary colors */
  --color-primary-50: #f0f9ff;
  --color-primary-100: #e0f2fe;
  --color-primary-200: #bae6fd;
  --color-primary-300: #7dd3fc;
  --color-primary-400: #38bdf8;
  --color-primary-500: #0ea5e9;
  --color-primary-600: #0284c7;
  --color-primary-700: #0369a1;
  --color-primary-800: #075985;
  --color-primary-900: #0c4a6e;
  --color-primary-950: #082f49;

  /* Default colors (neutral/gray) */
  --color-default-50: #fafafa;
  --color-default-100: #f4f4f5;
  --color-default-200: #e4e4e7;
  --color-default-300: #d4d4d8;
  --color-default-400: #a1a1aa;
  --color-default-500: #71717a;
  --color-default-600: #52525b;
  --color-default-700: #3f3f46;
  --color-default-800: #27272a;
  --color-default-900: #18181b;
  --color-default-950: #09090b;

  --color-danger: #ef4444; /* defaults to danger-500 */
  --color-primary: #0ea5e9;
  --color-default: #71717a;
  --color-success: #22c55e;
  --color-warning: #f59e0b;
  --color-secondary: #a855f7;

  /* Danger colors (red) */
  --color-danger-50: #fef2f2;
  --color-danger-100: #fee2e2;
  --color-danger-200: #fecaca;
  --color-danger-300: #fca5a5;
  --color-danger-400: #f87171;
  --color-danger-500: #ef4444;
  --color-danger-600: #dc2626;
  --color-danger-700: #b91c1c;
  --color-danger-800: #991b1b;
  --color-danger-900: #7f1d1d;
  --color-danger-950: #450a0a;

  /* Success colors (green) */
  --color-success-50: #f0fdf4;
  --color-success-100: #dcfce7;
  --color-success-200: #bbf7d0;
  --color-success-300: #86efac;
  --color-success-400: #4ade80;
  --color-success-500: #22c55e;
  --color-success-600: #16a34a;
  --color-success-700: #15803d;
  --color-success-800: #166534;
  --color-success-900: #14532d;
  --color-success-950: #052e16;

  /* Warning colors (yellow/amber) */
  --color-warning-50: #fffbeb;
  --color-warning-100: #fef3c7;
  --color-warning-200: #fde68a;
  --color-warning-300: #fcd34d;
  --color-warning-400: #fbbf24;
  --color-warning-500: #f59e0b;
  --color-warning-600: #d97706;
  --color-warning-700: #b45309;
  --color-warning-800: #92400e;
  --color-warning-900: #78350f;
  --color-warning-950: #451a03;

  /* Secondary colors (purple) */
  --color-secondary-50: #faf5ff;
  --color-secondary-100: #f3e8ff;
  --color-secondary-200: #e9d5ff;
  --color-secondary-300: #d8b4fe;
  --color-secondary-400: #c084fc;
  --color-secondary-500: #a855f7;
  --color-secondary-600: #9333ea;
  --color-secondary-700: #7e22ce;
  --color-secondary-800: #6b21a8;
  --color-secondary-900: #581c87;
  --color-secondary-950: #3b0764;

  --font-exo-2: 'Exo 2', sans-serif;
}

@layer utilities {
  @reference "tailwindcss";
}

:root {
  --pd-border-color: oklch(92.2% 0 0); /* --color-neutral-100 */
  --pd-border-color-error: var(--color-red-200);
  --pd-default-bg: #fafafa;
}

/* Dark mode variables (applied when .dark is on theme root) */
#paper-debugger-root.dark,
html.dark {
  --pd-border-color: oklch(35% 0 0);
  --pd-border-color-error: var(--color-red-400);
  --pd-default-bg: #18181b;
}

body {
  font-family:
    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue",
    sans-serif;
}

/* Overleaf Compatibility Fixes (tricks) */
img,
svg {
  display: inline-block;
  vertical-align: middle;
}

/* Block-level media elements */
video,
canvas,
audio,
iframe,
embed,
object {
  display: block;
}

.collapse {
  visibility: visible !important;
}
/* Overleaf Compatibility Fixes (tricks) */

/* Others */
.noselect {
  -webkit-touch-callout: none;
  /* iOS Safari */
  -webkit-user-select: none;
  /* Safari */
  -khtml-user-select: none;
  /* Konqueror HTML */
  -moz-user-select: none;
  /* Firefox */
  -ms-user-select: none;
  /* Internet Explorer/Edge */
  user-select: none;
  /* Non-prefixed version, currently supported by Chrome and Opera */
}

.canselect {
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  user-select: text;
}

.nodrag {
  -webkit-user-drag: none;
  -webkit-user-select: none;
  -webkit-user-select: none;
}

.text-exo-2 {
  font-family: var(--font-exo-2);
  font-optical-sizing: auto;
  font-style: normal;
}

@keyframes ellipsis {
  0% {
    opacity: 0;
  }

  50% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
}

@keyframes toolCardAppear {
  from {
    opacity: 0;
    transform: translateY(10px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Fix the cursor color because of HeroUI changed `border-color` globally.
 * https://github.com/PaperDebugger/overleaf/issues/54 
*/
.cm-cursor {
  border-color: unset !important;
  border-style: none none none solid !important;
}

/* Tool Card Begin */
.tool-card {
  @apply overflow-hidden max-w-xl p-4 my-2;
  border-color: var(--pd-border-color) !important;
}

.tool-card.narrow {
  @apply px-0! py-1 my-1 bg-transparent;
}

.tool-card.animated {
  opacity: 0;
  animation: toolCardAppear 0.5s ease-out 200ms forwards;
  transition-behavior: allow-discrete;
}

.tool-card-title {
  @apply text-[10px] font-semibold font-sans text-primary-700 tracking-wider select-none;
}

.tool-card-title {
  @apply font-medium text-gray-500 dark:text-default-500;
}

.tool-card.compact {
  @apply px-0 py-0 my-0.5 bg-transparent text-xs border-0;
}

.tool-card.compact .tool-card-title {
  @apply text-[10px];
}

/* 相邻 tool-card 的样式处理 */
.tool-card + .tool-card {
  /* 相邻的第二个卡片：移除上边框，调整上圆角，减少上边距，减少上 padding */
  @apply border-t-0 rounded-t-none -mt-2 pt-0;
}

.tool-card:has(+ .tool-card) {
  /* 有相邻下一个卡片的卡片：移除下边框，调整下圆角，减少下边距 */
  @apply border-b-0 rounded-b-none my-0;
}

/* 处理相邻卡片之间的间距 */
.tool-card:not(.tool-card + .tool-card) {
  /* 非相邻卡片组的第一个卡片保持正常边距 */
  @apply mt-0;
}

.tool-card + .tool-card:not(:has(+ .tool-card)) {
  /* 相邻卡片组的最后一个卡片：恢复下圆角 */
  @apply rounded-b-xl;
}

/* Tool Card End */

@property --opacity {
  syntax: "<number>";
  initial-value: 0;
  inherits: false;
}

.fade-in {
  animation: fadeIn 0.5s ease-in-out forwards;
}

.fade-in-word {
  opacity: 0;
  animation: fadeIn 0.8s ease-out forwards;
  animation-delay: var(--delay);
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}

/* PromptInput focus border effect */
.prompt-input-container {
  transition: border-color 0.2s;
}

.prompt-input-container:focus-within {
  border-color: #58b985 !important;
  /* Tailwind blue-500 */
}

.modal-zindex-important {
  z-index: 9999 !important;
}

.pd-app-container {
  display: flex;
  flex-direction: column;
  border-radius: 0.75rem;
  border: 1px solid;
  background-color: transparent;
  overflow: hidden;
  @apply overflow-hidden w-full h-full dark:border-default-200! border-default-200!;
}

.pd-app-control-title-bar {
  @apply bg-gray-100 dark:bg-default-100!;
  flex: 0;
  overflow: hidden;
  position: fixed;
  height: 40px;
  display: flex;
  align-items: center;
  z-index: 999;
  @apply transition-all;
}

.pd-app-control-title-bar.collapsed {
  max-width: 58px; /* 你想要的 collapsed 宽度 */
  overflow: hidden;
}
.pd-app-control-title-bar.expanded {
  max-width: 136px; /* 或者展开时的宽度 */
  overflow: hidden;
}

.pd-app-control-title-bar .pd-app-small-control-button {
  @apply text-gray-500 dark:text-default-500 font-light rounded-md p-[0.25rem] transition-all;
  @apply hover:bg-gray-200 dark:hover:bg-default-200 hover:text-gray-700 dark:hover:text-default-200;
  @apply active:bg-gray-300 dark:active:bg-default-300 active:text-gray-800 dark:active:text-default-100;
  /* 鼠标弹起的时候不要触发 hover */
  @apply hover:cursor-pointer;
  @apply active:cursor-pointer;
}

.pd-app-header-container {
  @apply bg-red-100 dark:bg-default-100!;
  flex: 0;
}

/* 包含 TabItems 和 TabContent */
.pd-app-body-container {
  background-color: var(--pd-default-bg);
  flex: 1;
  display: flex;
  flex-direction: row;
  height: 100%;
  /* 必须有这个，*/
}

.pd-app-tab-items {
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  border-right: 1px solid var(--pd-border-color);
  gap: 1rem;
  @apply bg-gray-100 dark:bg-default-100! px-3 pb-3 pt-12;
  z-index: 888;
  position: relative;
  flex-shrink: 0;
}

.pd-chat-item-container-messages {
  @apply flex flex-col px-2;
}

.pd-app-tab-content {
  /* 填满 pd-app-body-container */
  height: 100%;
  width: 100%;
  min-width: 0;
  flex-direction: column;
  z-index: 999;
  display: flex;
}

.pd-app-tab-content .pd-app-tab-content-header {
  @apply bg-gray-100 dark:bg-default-100! pl-3 pr-1 py-2 gap-2 items-center w-full h-4 text-xs transition-all;
  flex: 0;
  flex-direction: row;
  display: flex;
  height: 32px;
  border-bottom: 1px solid var(--pd-border-color);
}

.pd-app-tab-content .pd-app-tab-content-header.collapsed {
  @apply bg-gray-100 dark:bg-default-100! px-3 py-2 gap-2 items-center w-full h-4 text-xs transition-all;
  flex: 0;
  flex-direction: row;
  display: flex;
  height: 16px;
}

.pd-app-tab-content .pd-app-tab-content-body {
  display: flex;
  flex-direction: column;
  overflow: auto;
  min-height: 0px;
  width: 100%;
  min-width: 0;
  flex: 1;
  overflow-anchor: none;
  @apply bg-gray-50 dark:bg-default-50! p-2;
}

.pd-app-tab-content .pd-app-tab-content-footer {
  flex: 0;
  width: 100%;
  border-top: 1px solid var(--pd-border-color);
}

.chat-prompt-input .pd-selected-text-indicator {
  @apply w-full rounded-lg rounded-b-none! border-gray-200! dark:border-default-200! border border-b-0! text-gray-500 dark:text-default-500 text-nowrap text-ellipsis overflow-hidden max-h-[32px] cursor-pointer bg-gray-50 dark:bg-default-100! hover:bg-gray-100 dark:hover:bg-default-200;
  @apply transition-all;
}

.chat-prompt-input .pd-selected-text-indicator-clear {
  @apply rounded-full w-4 h-4 p-0.5 flex items-center justify-center text-gray-500 dark:text-default-500 cursor-pointer bg-gray-50 dark:bg-default-100! hover:bg-red-200 dark:hover:bg-danger-200 hover:text-red-500 dark:hover:text-danger transition-all;
  @apply absolute top-1/2 right-4 -translate-y-1/2;
}

.chat-message-entry {
  width: 100%;
  display: flex;
  flex-direction: column;
}

.chat-message-entry .indicator {
  @apply transition-all duration-300 ease-in-out select-none;
  @apply bg-transparent px-2;
  animation: fadeIn 0.5s ease-in-out forwards;
  text-wrap-style: balance;
  overflow: hidden;
  pointer-events: none;
}

.tool-card .indicator {
  @apply px-0;
}

.chat-message-entry .indicator.preparing {
  @apply opacity-100 h-6 mb-0;
}

.chat-message-entry .indicator.prepared {
  @apply opacity-0 m-0 p-0;
  height: 0;
  max-height: 0;
}

/* prepared 后的下一个兄弟元素不需要上边距 */
.chat-message-entry .indicator.prepared + * {
  margin-top: 0;
}

.chat-message-entry .indicator.incomplete {
  @apply text-sm text-default-400 dark:text-default-50;
}

.chat-message-entry .message-box-user-wrapper {
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
  gap: 4px;
  width: 100%;
}

.chat-message-entry .message-box-user {
  max-width: min(70%, 700px);
  min-width: 0;
  overflow-wrap: break-word;
  word-wrap: break-word;
  @apply text-sm text-default-800 px-3 py-2 border border-transparent! rounded-xl;
  @apply transition-all duration-500 ease-in-out;
  @apply bg-gray-200 dark:bg-default-200!;
}

.chat-message-entry .message-box-assistant {
  align-self: flex-start;
  max-width: min(95%, 700px);
  min-width: 0;
  @apply text-sm text-default-800 border border-transparent! rounded-xl;
  @apply transition-all duration-500 ease-in-out;
}

.chat-message-entry .message-box-assistant > * {
  max-width: 100%;
  min-width: 0;
  overflow-x: auto;
}

.chat-message-entry .actions {
  display: flex;
  flex-direction: row;
  justify-content: flex-start;
  align-items: flex-end;
  @apply text-gray-400 opacity-0 transition-all duration-100;
}

.chat-message-entry:hover .actions {
  /* height: 24px; */
  @apply opacity-100;
}

.chat-message-entry .actions .icon {
  cursor: pointer;
  font-size: 24px;
  @apply hover:text-gray-500 dark:hover:text-default-400 hover:bg-gray-200 dark:hover:bg-default-200 rounded-md p-1 transition-all duration-100;
}

.message-box-stale {
  @apply bg-red-50! dark:bg-danger-50/30! border!;
  border-color: var(--pd-border-color-error) !important;
}

.message-box-stale-description {
  @apply text-sm! text-red-400! border-t! mt-2! pt-1!;
  animation: fadeIn 0.5s ease-in-out forwards;
  border-color: var(--pd-border-color-error) !important;
}

.pd-message {
  ul {
    list-style-type: disc;
  }

  li {
    margin-left: 1rem;
  }
}

.chat-prompt-input {
  @apply p-2;
  @apply bg-gray-50 dark:bg-default-50!;
}

.chat-prompt-input .pd-chat-toolbar {
  @apply pb-2 transition-all ease-in-out;
}

.chat-prompt-input .pd-chat-toolbar.collapsed {
  @apply pb-0 max-h-0 overflow-hidden;
}

.pd-avatar {
  @apply w-10 h-10 rounded-xl outline outline-2 border-2 border-white dark:border-default-100! outline-gray-300 dark:outline-default-200 transition-all;
}

.pd-avatar-fallback {
  @apply text-xs font-extralight text-gray-400 dark:text-default-500 flex items-center justify-center text-center;
}

.pd-bottom-logo-group {
  @apply font-bold flex flex-wrap flex-col text-gray-500 dark:text-default-500;
  @apply transition-all;
  font-family: var(--font-exo-2);
  font-optical-sizing: auto;
  font-style: normal;
}

.pd-rnd {
  box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;
  transition:
    box-shadow 0.2s,
    opacity 0.3s;
}

.pd-rnd:hover {
  box-shadow: rgba(0, 0, 0, 0.2) 0px 4px 12px;
}

.pd-rnd.dragging {
  box-shadow: rgba(0, 0, 0, 0.2) 0px 4px 12px; /* horizontal, vertical, blur, spread */
}

.pd-context-menu {
  @apply bg-white dark:bg-default-100! rounded-md shadow-md border border-gray-200! dark:border-default-200! max-w-[150px] absolute top-8 left-4 hidden;
  @apply p-2;
}

.pd-context-menu.show {
  @apply block;
}

.pd-context-menu-item-group {
  @apply flex flex-col gap-2;
}
.pd-context-menu-item {
  @apply p-2 rounded-md text-sm font-medium text-gray-700 dark:text-default-200 cursor-pointer border border-gray-100! dark:border-default-200!;
  @apply hover:bg-gray-100 dark:hover:bg-default-200;
}

/* Google */
.gsi-material-button {
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  -webkit-appearance: none;
  background-color: WHITE;
  background-image: none;
  border: 1px solid #747775;
  -webkit-border-radius: 8px;
  border-radius: 8px;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
  color: #1f1f1f;
  cursor: pointer;
  font-family: "Roboto", arial, sans-serif;
  font-size: 14px;
  height: 32px;
  letter-spacing: 0.25px;
  outline: none;
  overflow: hidden;
  padding: 0 12px;
  position: relative;
  text-align: center;
  -webkit-transition:
    background-color 0.218s,
    border-color 0.218s;
  transition:
    background-color 0.218s,
    border-color 0.218s;
  vertical-align: middle;
  white-space: nowrap;
  width: auto;
  min-width: 196px;
  min-height: 32px;
}

.gsi-material-button .gsi-material-button-icon {
  height: 12px;
  width: 12px;
  margin-right: 20px;
  min-width: 12px;
}

.gsi-material-button .gsi-material-button-content-wrapper {
  -webkit-align-items: center;
  align-items: center;
  display: flex;
  -webkit-flex-direction: row;
  flex-direction: row;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  height: 100%;
  justify-content: space-between;
  position: relative;
  width: 100%;
}

.gsi-material-button .gsi-material-button-contents {
  -webkit-flex-grow: 1;
  flex-grow: 1;
  font-family: "Roboto", arial, sans-serif;
  font-weight: 500;
  font-size: 13.5px;
  overflow: hidden;
  text-overflow: ellipsis;
  vertical-align: top;
}

.gsi-material-button .gsi-material-button-state {
  -webkit-transition: opacity 0.218s;
  transition: opacity 0.218s;
  bottom: 0;
  left: 0;
  opacity: 0;
  position: absolute;
  right: 0;
  top: 0;
}

.gsi-material-button:disabled {
  cursor: default;
  background-color: #ffffff61;
  border-color: #1f1f1f1f !important;
}

.gsi-material-button:disabled .gsi-material-button-contents {
  opacity: 38%;
}

.gsi-material-button:disabled .gsi-material-button-icon {
  opacity: 38%;
}

.gsi-material-button:not(:disabled):active .gsi-material-button-state,
.gsi-material-button:not(:disabled):focus .gsi-material-button-state {
  background-color: #303030;
  opacity: 12%;
}

.gsi-material-button:not(:disabled):hover .gsi-material-button-state {
  background-color: #303030;
  opacity: 8%;
}

.pd-continue-with-overleaf {
  -webkit-flex-grow: 1;
  flex-grow: 1;
  font-family: "Roboto", arial, sans-serif;
  font-weight: 400;
  font-size: 13.5px;
  overflow: hidden;
  text-overflow: ellipsis;
  vertical-align: top;
  text-align: right;
}

/* Embed Sidebar Styles */
#pd-embed-sidebar {
  background-color: var(--pd-default-bg);
  position: relative;
  overflow: hidden;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
}

#pd-embed-sidebar .pd-app-container {
  border-radius: 0;
  border: none;
  border-left: 1px solid var(--pd-border-color);
  background-color: var(--pd-default-bg);
  position: relative;
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.pd-embed-resize-handle {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 8px;
  cursor: col-resize;
  background-color: transparent;
  transition:
    background-color 0.2s,
    opacity 0.2s;
  z-index: 10000;
  pointer-events: auto;
  display: flex;
  align-items: center;
  justify-content: center;
}

.pd-embed-resize-handle:hover {
  background-color: rgba(59, 130, 246, 0.1);
}

.pd-embed-resize-handle:hover .resize-handle-indicator {
  opacity: 1 !important;
}

.resize-handle-indicator {
  width: 2px;
  height: 40px;
  background-color: var(--pd-primary-color, #3b82f6);
  border-radius: 1px;
  opacity: 0;
  transition: opacity 0.2s;
}

/* Tab Items Resize Handle */
.pd-tab-items-resize-handle {
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  width: 8px;
  cursor: col-resize;
  background-color: transparent;
  transition:
    background-color 0.2s,
    opacity 0.2s;
  z-index: 1000;
  pointer-events: auto;
  display: flex;
  align-items: center;
  justify-content: center;
}

.pd-tab-items-resize-handle:hover {
  background-color: rgba(59, 130, 246, 0.1);
}

.pd-tab-items-resize-handle:hover .resize-handle-indicator {
  opacity: 1 !important;
}

.pd-tab-items-resize-handle.resizing {
  background-color: rgba(59, 130, 246, 0.2) !important;
}

.pd-tab-items-resize-handle.resizing .resize-handle-indicator {
  opacity: 1 !important;
}

/* List item: keep ::marker and first <p> on same line (Tailwind doesn't scan streamdown, so [&>p]:inline has no effect) */
[data-streamdown="list-item"] > p {
  display: inline;
}

[data-streamdown="inline-code"] {
  @apply px-1! py-0! text-xs! bg-gray-200! dark:bg-default-200! rounded-md font-mono text-default-800 dark:text-default-800!;
}

[data-streamdown="code-block"] {
  border-radius: 0.5rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.dark [data-streamdown="code-block"] {
  @apply border-default-200! dark:border-default-200!;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

[data-streamdown="code-block-header"] {
  @apply border-default-200! dark:border-default-200!;
  @apply py-1! px-2!;
}

[data-streamdown="code-block-body"] {
  @apply border-default-200! dark:border-default-200!;
  @apply py-2! px-3! text-xs!;
}

[data-streamdown="mermaid-block"] {
  @apply border-default-200! dark:border-default-200!;
}

[data-streamdown="horizontal-rule"] {
  @apply border-default-200! dark:border-default-200!;
}
